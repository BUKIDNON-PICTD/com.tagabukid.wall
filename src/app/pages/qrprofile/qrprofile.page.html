<ion-header>
  <ion-toolbar *ngIf="viewEntered && allowcreate">
    <ion-title>Capture Personal Information
      {{personInformationForm.get('lastname').value + ', ' + personInformationForm.get('firstname').value + ' ' + personInformationForm.get('middlename').value}}
    </ion-title>
    <ion-buttons slot="start">
      <ion-button *ngIf="!isbeginning" (click)="prev()">
        <ion-icon slot="start" name="arrow-back"></ion-icon> Prev
      </ion-button>
      <ion-button *ngIf="isbeginning">
        <ion-back-button [defaultHref]="defaultHref"></ion-back-button>
      </ion-button>
    </ion-buttons>
    <ion-buttons slot="end">
      <ion-button *ngIf="!isend" (click)="next()">Next <ion-icon slot="end" name="arrow-forward"></ion-icon>
      </ion-button>
      <ion-button *ngIf="isend && ispolicyagree" (click)="save()">Save <ion-icon slot="end" name="save"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>

  <ion-toolbar *ngIf="!allowcreate">
    <ion-title>QR LIMIT EXCEEDED</ion-title>
  </ion-toolbar>
</ion-header>
<ion-content class="ion-padding" *ngIf="viewEntered && allowcreate">
  <ion-slides #personProfileSlider pager='true' (ionSlideWillChange)="slideChanged()" (ionSlidesDidLoad)="slideLoad()">
    <ion-slide>
      <form [formGroup]="personInformationForm">
        <!-- {{personInformationForm.value | json}} -->
        <ion-toolbar color="primary">
          <nav class="navbar navbar-expand navbar-primary navbar-dark">
            <ion-title>Personal Information</ion-title>
          </nav>
        </ion-toolbar>
        <ion-item>
          <ion-label position="floating">Last Name</ion-label>
          <ion-input class="text-uppercase" oninput="this.value = this.value.toUpperCase()" inputmode="text"
            formControlName="lastname"></ion-input>
        </ion-item>
        <div *ngFor="let validation of validation_messages.lastname">
          <ng-container
            *ngIf="(isSubmitted && personInformationForm.get('lastname')?.hasError(validation.type)) || (personInformationForm.get('lastname')?.hasError(validation.type) && (personInformationForm.get('lastname')?.dirty || personInformationForm.get('lastname')?.touched))">
            <small class="text-danger">{{ validation.message }}</small>
          </ng-container>
        </div>
        <ion-item>
          <ion-label position="floating">First Name</ion-label>
          <ion-input class="text-uppercase" oninput="this.value = this.value.toUpperCase()" inputmode="text"
            formControlName="firstname"></ion-input>
        </ion-item>
        <div *ngFor="let validation of validation_messages.firstname">
          <ng-container
            *ngIf="(isSubmitted && personInformationForm.get('firstname')?.hasError(validation.type)) || (personInformationForm.get('firstname')?.hasError(validation.type) && (personInformationForm.get('firstname')?.dirty || personInformationForm.get('firstname')?.touched))">
            <small class="text-danger">{{ validation.message }}</small>
          </ng-container>
        </div>

        <ion-item>
          <ion-label position="floating">Middle Name</ion-label>
          <ion-input class="text-uppercase" oninput="this.value = this.value.toUpperCase()" inputmode="text"
            formControlName="middlename"></ion-input>
        </ion-item>
        <div *ngFor="let validation of validation_messages.middlename">
          <ng-container
            *ngIf="(isSubmitted && personInformationForm.get('middlename')?.hasError(validation.type)) || (personInformationForm.get('middlename')?.hasError(validation.type) && (personInformationForm.get('middlename')?.dirty || personInformationForm.get('middlename')?.touched))">
            <small class="text-danger">{{ validation.message }}</small>
          </ng-container>
        </div>


        <ion-item>
          <ion-label position="floating">Name Extension</ion-label>
          <ion-input class="text-uppercase" oninput="this.value = this.value.toUpperCase()" inputmode="text"
            formControlName="nameextension"></ion-input>
        </ion-item>
        <div *ngFor="let validation of validation_messages.nameextension">
          <ng-container
            *ngIf="(isSubmitted && personInformationForm.get('nameextension')?.hasError(validation.type)) || (personInformationForm.get('nameextension')?.hasError(validation.type) && (personInformationForm.get('nameextension')?.dirty || personInformationForm.get('nameextension')?.touched))">
            <small class="text-danger">{{ validation.message }}</small>
          </ng-container>
        </div>

        <ion-item>
          <ion-label position="floating">Birth Date</ion-label>
          <ion-datetime displayFormat="MM/DD/YYYY" formControlName="birthdate" placeholder="Select Date">
          </ion-datetime>
        </ion-item>
        <div *ngFor="let validation of validation_messages.birthdate">
          <ng-container
            *ngIf="(isSubmitted && personInformationForm.get('birthdate')?.hasError(validation.type)) || (personInformationForm.get('birthdate')?.hasError(validation.type) && (personInformationForm.get('birthdate')?.dirty || personInformationForm.get('birthdate')?.touched))">
            <small class="text-danger">{{ validation.message }}</small>
          </ng-container>
        </div>

        <ion-item>
          <ion-label position="floating">Gender</ion-label>
          <ion-select placeholder="Select One" formControlName="gender">
            <ion-select-option value="F">Female</ion-select-option>
            <ion-select-option value="M">Male</ion-select-option>
          </ion-select>
        </ion-item>
        <div *ngFor="let validation of validation_messages.gender">
          <ng-container
            *ngIf="(isSubmitted && personInformationForm.get('gender')?.hasError(validation.type)) || (personInformationForm.get('gender')?.hasError(validation.type) && (personInformationForm.get('gender')?.dirty || personInformationForm.get('gender')?.touched))">
            <small class="text-danger">{{ validation.message }}</small>
          </ng-container>
        </div>

        <ion-item>
          <ion-label position="floating">Civil Status</ion-label>
          <ion-select placeholder="Select One" formControlName="civilstatus">
            <ion-select-option value="SINGLE">SINGLE</ion-select-option>
            <ion-select-option value="MARRIED">MARRIED</ion-select-option>
            <ion-select-option value="COUPLE">COUPLE</ion-select-option>
            <ion-select-option value="SEPARATED">SEPARATED</ion-select-option>
            <ion-select-option value="WIDOW">WIDOW/WIDOWER</ion-select-option>
          </ion-select>
        </ion-item>
        <div *ngFor="let validation of validation_messages.civilstatus">
          <ng-container
            *ngIf="(isSubmitted && personInformationForm.get('civilstatus')?.hasError(validation.type)) || (personInformationForm.get('civilstatus')?.hasError(validation.type) && (personInformationForm.get('civilstatus')?.dirty || personInformationForm.get('civilstatus')?.touched))">
            <small class="text-danger">{{ validation.message }}</small>
          </ng-container>
        </div>

        <ion-item>
          <ion-label position="floating">Mobile Number</ion-label>
          <ion-input class="text-uppercase" oninput="this.value = this.value.toUpperCase()" inputmode="tel"
            formControlName="mobileno"></ion-input>
        </ion-item>
        <div *ngFor="let validation of validation_messages.mobileno">
          <ng-container
            *ngIf="(isSubmitted && personInformationForm.get('mobileno')?.hasError(validation.type)) || (personInformationForm.get('mobileno')?.hasError(validation.type) && (personInformationForm.get('mobileno')?.dirty || personInformationForm.get('mobileno')?.touched))">
            <small class="text-danger">{{ validation.message }}</small>
          </ng-container>
        </div>

        <ion-toolbar color="primary">
          <nav class="navbar navbar-expand navbar-primary navbar-dark">
            <ion-title>Address</ion-title>
          </nav>
        </ion-toolbar>
        <div formGroupName="province">
          <ion-item>
            <ion-label position="floating">Province</ion-label>
            <ion-select placeholder="Select One" formControlName="code" (ionChange)="onProvinceChange()">
              <ion-select-option *ngFor="let province of provinces" value="{{province.code}}">{{province.lguname}}</ion-select-option>
            </ion-select>
          </ion-item>
          <div *ngFor="let validation of validation_messages.province">
            <ng-container
              *ngIf="(isSubmitted && personInformationForm.get('province.code')?.hasError(validation.type)) || (personInformationForm.get('province.code')?.hasError(validation.type) && (personInformationForm.get('province.code')?.dirty || personInformationForm.get('province.code')?.touched))">
              <small class="text-danger">{{ validation.message }}</small>
            </ng-container>
          </div>
        </div>
        <div formGroupName="municipality">
          <ion-item>
            <ion-label position="floating">Municipality/City</ion-label>
            <ion-select placeholder="Select One" formControlName="code" (ionChange)="onMunicipalityChange()">
              <ion-select-option *ngFor="let municipality of municipalities" value="{{municipality.code}}">{{municipality.lguname}}</ion-select-option>
            </ion-select>
          </ion-item>
          <div *ngFor="let validation of validation_messages.municipality">
            <ng-container
              *ngIf="(isSubmitted && personInformationForm.get('municipality.code')?.hasError(validation.type)) || (personInformationForm.get('municipality.code')?.hasError(validation.type) && (personInformationForm.get('municipality.code')?.dirty || personInformationForm.get('municipality.code')?.touched))">
              <small class="text-danger">{{ validation.message }}</small>
            </ng-container>
          </div>
        </div>
        <div formGroupName="barangay">
          <ion-item>
            <ion-label position="floating">Barangay</ion-label>
            <ion-select placeholder="Select One" formControlName="code">
              <ion-select-option *ngFor="let barangay of barangays" value="{{barangay.code}}">{{barangay.lguname}}</ion-select-option>
            </ion-select>
          </ion-item>
          <div *ngFor="let validation of validation_messages.barangay">
            <ng-container
              *ngIf="(isSubmitted && personInformationForm.get('barangay.code')?.hasError(validation.type)) || (personInformationForm.get('barangay.code')?.hasError(validation.type) && (personInformationForm.get('barangay.code')?.dirty || personInformationForm.get('barangay.code')?.touched))">
              <small class="text-danger">{{ validation.message }}</small>
            </ng-container>
          </div>
        </div>
        <ion-item>
          <ion-label position="floating">Street/Purok</ion-label>
          <ion-input class="text-uppercase" oninput="this.value = this.value.toUpperCase()" inputmode="text"
            formControlName="street"></ion-input>
        </ion-item>
        <div *ngFor="let validation of validation_messages.street">
          <ng-container
            *ngIf="(isSubmitted && personInformationForm.get('street')?.hasError(validation.type)) || (personInformationForm.get('street')?.hasError(validation.type) && (personInformationForm.get('street')?.dirty || personInformationForm.get('street')?.touched))">
            <small class="text-danger">{{ validation.message }}</small>
          </ng-container>
        </div>
       
        <p>&nbsp;</p>
      </form>
    </ion-slide>
    <ion-slide>
      <div>
        <ion-toolbar color="primary">
          <nav class="navbar navbar-expand navbar-primary navbar-dark">
            <ion-title>Profile Photo</ion-title>
            <ion-button fill="clear" expand="full" color="light" (click)="selectImage()">
              <ion-icon slot="start" name="camera"></ion-icon>
              Capture Photo
            </ion-button>
          </nav>
        </ion-toolbar>
        <ion-list>
          <ion-item>
            <img [src]="photo" />
          </ion-item>
        </ion-list>
      </div>
    </ion-slide>
    <ion-slide>
      <ion-card>
        <ion-card-header>
          <ion-card-title>Privacy Policy</ion-card-title>
        </ion-card-header>
      
        <ion-card-content>
          This contact tracing application will collect the minimum basic personal data from you that may be used to fight the COVID-19 pandemic. The data collected will be used to speed up the tracing of possible contacts of persons that may or may not be infected with the virus. Your personal data will be collected at points of entry in establishments, institutions, offices, or places where you may come into contact with persons infected or suspected to be infected with the virus. Entry points will collect data via smartphones which when it is online will automatically upload the data to servers at the Provincial Capitol and at the same time delete the data from the smartphone. These minimum personal data will be kept at the Provincial Government of Bukidnon Servers for a certain period of time before it is deemed immaterial for contact tracing and subsequently deleted from storage.
        </ion-card-content>
        <ion-item>
          <ion-label>Agree</ion-label>
          <ion-checkbox [(ngModel)]="ispolicyagree" (ionChange)="updatePolicyAgree()"></ion-checkbox>
        </ion-item>
      </ion-card>
      <p>&nbsp;</p>
    </ion-slide>
  </ion-slides>
</ion-content>